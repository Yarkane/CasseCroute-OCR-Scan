<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Uploader - CasseCroute OCR</title>
  <style>
    :root{--bg:#2b0b3a;--card:#3a114e;--accent:#9b59ff;--txt:#f5eaff}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;color:var(--txt);background:linear-gradient(180deg,var(--bg),#1e0726);min-height:100vh;display:flex;align-items:center;justify-content:center}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));padding:28px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.4);width:420px}
    .logo{display:flex;align-items:center;gap:12px;margin-bottom:18px}
    .logo img{width:56px;height:56px;object-fit:contain;border-radius:8px}
    h1{font-size:18px;margin:0}
    p{margin:6px 0 16px;color:rgba(245,234,255,0.85)}
    form{display:flex;flex-direction:column;gap:12px}
    input[type=file]{background:transparent;color:var(--txt)}
    button{background:var(--accent);border:none;color:#1a0022;padding:10px 12px;border-radius:8px;font-weight:600;cursor:pointer}
    footer{margin-top:10px;font-size:12px;color:rgba(245,234,255,0.6)}
    .note{font-size:13px;color:rgba(255,255,255,0.8)}
  </style>
</head>
<body>
  <div class="card">
    <div class="logo">
      <img src="{{.LogoPath}}" alt="logo"/>
      <div>
        <h1>CasseCroute OCR - Upload</h1>
        <p>Déposez un fichier pour le traitement OCR.</p>
      </div>
    </div>

    <form action="/upload" method="post" enctype="multipart/form-data">
      <input type="file" name="file" required />
      <div style="display:flex;justify-content:space-between;align-items:center">
        <button type="submit">Envoyer</button>
        <span class="note">Fichiers max 50MB</span>
      </div>
    </form>

    <footer>
      <p>Les fichiers envoyés seront placés dans le dossier configuré pour l'entrée.</p>
    </footer>
  </div>
  <div style="position:fixed;right:20px;bottom:20px;width:480px;max-height:60vh;overflow:auto">
    <div style="background:rgba(0,0,0,0.35);padding:12px;border-radius:8px;color:#fff">
      <div style="font-weight:700;margin-bottom:8px">Debug (en temps réel)</div>
      <pre id="debug" style="white-space:pre-wrap;word-break:break-word;max-height:50vh;overflow:auto;font-size:13px;background:transparent;margin:0"></pre>
    </div>
  </div>
  <script>
    function qs(name){
      return new URLSearchParams(window.location.search).get(name);
    }
    const debugFile = qs('debug');
    if(debugFile){
      const out = document.getElementById('debug');
      const es = new EventSource('/stream?file='+encodeURIComponent(debugFile));
      es.onmessage = function(e){
        out.textContent += e.data + '\n';
        out.scrollTop = out.scrollHeight;
      };
      es.onerror = function(){
        // reconnect handled by browser automatically for EventSource
      };
    }
  </script>
</body>
</html>